@def title = "statistics"
@def tags = ["syntax", "code"]

# ベイズ推論

\tableofcontents

## 統計的推測

データを支配している、未知で観測不可能な確率分布を真の確率分布と呼ぶ。サンプルはこの真の確率分布に従って生成されていると考え、このときのサンプルを $x^n = (x_1, x_2, \dots, x_i, \dots , x_n)$とする。

標本抽出などで得られたサンプルを元に確率分布モデルを組み合わせて、真の確率分布の推測を行うことを**統計的推測**と呼ぶ。

ベイズ推論は統計的推測の手法の一つである。

分析者は確率モデルを組み合わせることで、分析対象のサンプルを生成するような真の確率分布は$p^{*}(x)$だろうと推測を行う。この$p^{*}(x)$を**予測分布**と呼ぶ。

統計的推測では予測分布によって推論を行うので、以下ではまず予測分布を構成する。

また、生成されたサンプルは標本抽出などでのデータの取られ方によって確率的に揺らぐ。そのためサンプルによって結果は変動することが分かる。従って、サンプルを確率変数の実現値として考える。


![bayes_outline](https://daikichiba9511.github.io/mysite/statistics/images/statistics01_images/bayes_outline.png)

## 予測分布

予測分布を構成するために、まずパラメータの事後分布について定義する。その後定義した事後分布を用いて予測分布を定義する。

\definition{事後分布}{
確率分布モデルを$p(x | w)$、この時、パラメータwの事前分布を$\varphi(w)$とおく。

定数$\beta$を$0 < \beta < \infty$を満たす実数であるとする。これを**逆温度**と呼ぶ。

このとき、パラメータ$w$、逆温度$\beta$の**事後分布**を

$$
p(w|X^n) = \frac{1}{Z_{n}(\beta)}\phi(w)\prod_{i=1}^{n}p(x_{i}|w)^{\beta}
$$

と定義する。ここで$Z_{n}(\beta)$は**分配関数**と呼ばれるもので

$$
Z_n(\beta) = \int_W \phi(w) \prod_{i=1}^n p(x_{i}|w)^{\beta}dw
$$

である。特に$\beta=1$のときの$Z_n(1)$を**周辺尤度**と呼ぶ。

}

\note{}{
    ここで定義した事後分布は確率変数であることに注意。\
    \
    これは分配関数がサンプルによって決まるので確率的に変動する、すなわち確率変数であるためである。\
    \
    サンプルが確率変数であるのでサンプルに依存して決まる値は確率的に値が変動することに注意されたい。
}

次に予測分布を構成する。そのために事後分布に関して平均を求める操作を以下のように定義する

\definition{事後分布に関する平均}{
パラメータ$w$の関数の関数f(w)に対して、事後分布 $p(w|x^{n})$ による平均値を

$$
\mathbb{E}_{w} [ f(w) ] = \int f(w) p(w | x^{n}) dw
$$

とする。これはパラメータ$w$について積分してるためwの関数ではないことに注意されたい。(3)もまたサンプルx^{n}によって確率的に変動する値である。
}

以上で定義してきた事後分布と(3)を用いて予測分布は以下のように定義される。

\definition{予測分布}{
    事後分布によって確率分布モデル $p(x | w)$ を平均したもの
    $$
    \begin{aligned}
        p^*(x) &= \mathbb{E}_{w} [ p(x | w) ] \\
                &= \int p(x | w)p(w|x^{n}) dw 
    \end{aligned}
    $$
    を**予測分布** という。これを$p^*(x)=p(x|x^n)$
    と書くこともある。
}

よって、分析対象のサンプルを生成している真の確率分布が上記で定義した予測分布であろうと推測するのがベイズ推測である。